System.register(["jimu-core/react","jimu-core","jimu-ui"],(function(e,t){var r={},n={},o={};return{setters:[function(e){r.default=e.default,r.useEffect=e.useEffect,r.useState=e.useState},function(e){n.SessionManager=e.SessionManager,n.jsx=e.jsx},function(e){o.Checkbox=e.Checkbox,o.Label=e.Label,o.TextInput=e.TextInput}],execute:function(){e((()=>{var e={93:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(601),o=r.n(n),a=r(314),i=r.n(a)()(o());i.push([e.id,".widget-form-container{width:100%;max-height:100%;overflow-y:auto;padding:16px;box-sizing:border-box;background-color:#fafafa;border-radius:8px;border:1px solid #ddd;display:flex;flex-direction:column}.widget-form-container h4{margin:0 0 16px;font-size:1.25rem;color:#333;flex:0 0 auto}.widget-form-fields{flex:1 1 auto;overflow-y:auto}.widget-form-field{margin-bottom:16px;display:flex;flex-direction:column}.widget-form-field label{font-weight:600;margin-bottom:4px;color:#444}.widget-form-field .jimu-ui-text-input,.widget-form-field .jimu-ui-checkbox{width:100%}.widget-form-error{margin-top:4px;color:#b00;font-size:.875rem}.widget-form-submit{margin-top:auto;align-self:flex-end;background-color:#00629b;color:#fff;padding:10px 18px;border:none;border-radius:4px;font-size:1rem;font-weight:600;cursor:pointer;flex:0 0 auto}.widget-form-submit:hover{background-color:#004f7c}@media(max-width: 480px){.widget-form-container{padding:12px}.widget-form-container h4{font-size:1.1rem}.widget-form-submit{width:100%;text-align:center}}",""]);const s=i},314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,o,a){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(n)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(i[c]=!0)}for(var d=0;d<e.length;d++){var u=[].concat(e[d]);n&&i[u[0]]||(void 0!==a&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=a),r&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=r):u[2]=r),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},601:e=>{"use strict";e.exports=function(e){return e[1]}},72:e=>{"use strict";var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var a={},i=[],s=0;s<e.length;s++){var c=e[s],d=n.base?c[0]+n.base:c[0],u=a[d]||0,l="".concat(d," ").concat(u);a[d]=u+1;var f=r(l),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==f)t[f].references++,t[f].updater(p);else{var m=o(p,n);n.byIndex=s,t.splice(s,0,{identifier:l,updater:m,references:1})}i.push(l)}return i}function o(e,t){var r=t.domAPI(t);r.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,o){var a=n(e=e||[],o=o||{});return function(e){e=e||[];for(var i=0;i<a.length;i++){var s=r(a[i]);t[s].references--}for(var c=n(e,o),d=0;d<a.length;d++){var u=r(a[d]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}a=c}}},659:e=>{"use strict";var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,r)=>{"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var o=void 0!==r.layer;o&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,o&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var a=r.sourceMap;a&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},244:e=>{"use strict";e.exports=n},972:e=>{"use strict";e.exports=r},321:e=>{"use strict";e.exports=o}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={id:r,exports:{}};return e[r](o,o.exports,a),o.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="",a.nc=void 0;var i={};return a.p=window.jimuConfig.baseUrl,(()=>{"use strict";a.r(i),a.d(i,{__set_webpack_public_path__:()=>y,default:()=>x});var e=a(972),t=a(244),r=a(321),n=a(72),o=a.n(n),s=a(825),c=a.n(s),d=a(659),u=a.n(d),l=a(56),f=a.n(l),p=a(540),m=a.n(p),g=a(113),b=a.n(g),v=a(93),h={};h.styleTagTransform=b(),h.setAttributes=f(),h.insert=u().bind(null,"head"),h.domAPI=c(),h.insertStyleElement=m();o()(v.A,h);v.A&&v.A.locals&&v.A.locals;function x(n){const o="https://portalgis.gna.gob.ar/server/rest/services/Hosted/Prueba1_Rts/FeatureServer/0",[a,i]=(0,e.useState)([]),[s,c]=(0,e.useState)({}),[d,u]=(0,e.useState)({}),[l,f]=(0,e.useState)(!0),[p,m]=(0,e.useState)(null),g=()=>{const e=t.SessionManager.getInstance().sessions,r=Object.keys(e)[0];return r?e[r]._token:""};(0,e.useEffect)((()=>{const e=g();fetch(`${o}?f=pjson&token=${e}`).then((e=>e.json())).then((e=>{if(!e.fields)throw new Error("No se encontr\xf3 definici\xf3n de campos");const t=e.fields.filter((e=>!/^(OBJECTID|Shape|GlobalID)$/i.test(e.name))).map((e=>{var t;let r="string";return/Integer|OID/i.test(e.type)?r="integer":/Double|Single/i.test(e.type)?r="float":/Date/i.test(e.type)&&(r="date"),{name:e.name,alias:e.alias||e.name,data_type:r,editable:null===(t=e.editable)||void 0===t||t}}));i(t);const r={};t.forEach((e=>{e.editable&&(r[e.name]="boolean"!==e.data_type&&"")})),c(r)})).catch((e=>m(e.message))).finally((()=>f(!1)))}),[]);const b=(e,t,r)=>{let n="";"integer"!==r||""===t||/^\d+$/.test(t)||(n="Debe ser un entero"),"float"===r&&""!==t&&isNaN(parseFloat(t))&&(n="Debe ser un n\xfamero"),"string"===r&&""===t.trim()&&(n="Requerido"),u((t=>Object.assign(Object.assign({},t),{[e]:n}))),n&&""!==t||c((n=>Object.assign(Object.assign({},n),{[e]:"integer"===r?""===t?"":parseInt(t,10):"float"===r?""===t?"":parseFloat(t):"boolean"===r?!!t:t})))};return l?(0,t.jsx)("div",null,"Cargando campos\u2026"):p?(0,t.jsx)("div",{style:{color:"red"}},"Error: ",p):(0,t.jsx)("div",{className:"widget-form-container"},(0,t.jsx)("h4",null,"Formulario basado en esquema de capa"),(0,t.jsx)("div",{className:"widget-form-fields"},a.map(((n,o)=>(0,t.jsx)("div",{key:o,className:"widget-form-field"},(0,t.jsx)(r.Label,null,n.alias),"boolean"===n.data_type?(0,t.jsx)(r.Checkbox,{checked:s[n.name],disabled:!n.editable,onChange:e=>b(n.name,e.target.checked,n.data_type)}):(0,t.jsx)(e.default.Fragment,null,(0,t.jsx)(r.TextInput,{type:"text",value:s[n.name],disabled:!n.editable,onChange:e=>b(n.name,e.target.value,n.data_type)}),d[n.name]&&(0,t.jsx)("div",{className:"widget-form-error"},d[n.name])))))),(0,t.jsx)("button",{className:"widget-form-submit",onClick:()=>{const e={};if(a.forEach((t=>{if(!t.editable)return;const r=s[t.name];"string"!==t.data_type&&"date"!==t.data_type||r||(e[t.name]="Requerido"),"integer"!==t.data_type||""!==r&&Number.isInteger(r)||(e[t.name]="Entero v\xe1lido"),"float"!==t.data_type||""!==r&&"number"==typeof r||(e[t.name]="N\xfamero v\xe1lido")})),u(e),Object.keys(e).length)return;const t=g(),r={attributes:s},n=`f=json&token=${t}&adds=${encodeURIComponent(JSON.stringify([r]))}`;fetch(`${o}/applyEdits`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n}).then((e=>e.json())).then((e=>{var t,r;if(!(null===(r=null===(t=e.addResults)||void 0===t?void 0:t[0])||void 0===r?void 0:r.success))throw new Error("Error al crear registro");{alert("Creado id "+e.addResults[0].objectId);const t={};a.forEach((e=>{e.editable&&(t[e.name]="boolean"!==e.data_type&&"")})),c(t),u({})}})).catch((e=>m(e.message)))}},"Enviar"))}function y(e){a.p=e}})(),i})())}}}));